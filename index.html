<!DOCTYPE html>
<html>
<head>
    <title>Login - Gretex Exit App</title>
    <link rel="stylesheet" href="style.css">
    <script src="config.js"></script> </head>
<body>
    <div class="login-box">
        <h2>Gretex Staff Login</h2>
        <input type="text" id="username" placeholder="Username">
        <input type="password" id="password" placeholder="Password">
        <button onclick="handleLogin()">Login</button>
        <p id="msg" style="color:red"></p>
    </div>

    <script>
        function handleLogin() {
            const u = document.getElementById('username').value;
            const p = document.getElementById('password').value;
            const btn = document.querySelector('button');
            const msg = document.getElementById('msg');

            btn.innerText = "Checking...";

            fetch(API_URL, {
                method: 'POST',
                body: JSON.stringify({ action: 'login', username: u, password: p })
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    // Browser me role save kar lo
                    sessionStorage.setItem('userRole', data.role);
                    sessionStorage.setItem('userName', u);

                    // REDIRECT LOGIC (Alag files par bhejo)
                    if(data.role === 'HR') window.location.href = 'hr_dashboard.html';
                    else if(data.role === 'IT') window.location.href = 'it_dashboard.html';
                    else if(data.role === 'Accounts') window.location.href = 'accounts_dashboard.html';
                    else if(data.role === 'Admin') window.location.href = 'admin_dashboard.html';
                    
                } else {
                    msg.innerText = data.message;
                    btn.innerText = "Login";
                }
            });
        }
    </script>
</body>
</html>
