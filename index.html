<!DOCTYPE html>
<html>
<head>
    <title>Gretex Login</title>
    <link rel="stylesheet" href="style.css">
    <script src="config.js"></script>
</head>
<body>
    <div class="login-box">
        <h2>Gretex Exit Portal</h2>
        <input type="text" id="u" placeholder="Username">
        <input type="password" id="p" placeholder="Password">
        <br><br>
        <button onclick="login()" class="btn-green">Login</button>
        <p id="msg" style="color:red; margin-top:10px;"></p>
    </div>

    <script>
        function login() {
            const u = document.getElementById('u').value;
            const p = document.getElementById('p').value;
            const msg = document.getElementById('msg');
            msg.innerText = "Checking...";

            fetch(API_URL, {
                method: 'POST',
                body: JSON.stringify({ action: 'login', username: u, password: p })
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    sessionStorage.setItem('userRole', data.role);
                    if(data.role == 'HR') window.location.href = 'hr_dashboard.html';
                    else if(data.role == 'IT') window.location.href = 'it_dashboard.html';
                    else if(data.role == 'Accounts') window.location.href = 'accounts_dashboard.html';
                    else if(data.role == 'Admin') window.location.href = 'admin_dashboard.html';
                } else {
                    msg.innerText = data.message;
                }
            });
        }
    </script>
</body>
</html>
